<!DOCTYPE html>
<html lang="en" class="scroll-smooth">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Safa Suiting</title>
  <link rel="shortcut icon" href="/assests/safaLogo.png" type="image/x-icon">
  <link rel="stylesheet" href="/styles/global.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.js"></script>

   <!-- AOS Library for Scroll Animations -->
   <!-- <link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" /> -->


</head>

<body class="transition-all duration-300 bg-[#FFFFFF] text-gray-900 dark:bg-gray-900 dark:text-gray-100 !scroll-smooth">
  
 
  <header
  class=" border-b border-gray-500 bg-[#FFFFFF] text-black dark:bg-gray-900 dark:text-gray-100  dark:border-gray-700 fixed top-0 left-0 w-full z-50 ">
  <!-- Top Bar -->
  <div class="bg-black text-white text-sm py-2 px-4 flex justify-center items-center dark:bg-gray-800">
    <span class="mr-2">Unleash the Summer Vibes: Dive into Style with Our Hot Deals and Free Delivery!</span>
    <a href="#" class="underline">ShopNow</a>
  </div>

  <!-- Main Navigation -->
  <div class="flex justify-between items-center py-5 px-4 lg:px-24 md:px-8">
    <!-- Logo -->
    <!-- <div class="lg:text-2xl text-xl font-bold">Safa Suiting</div> -->
    <a href="/">
      <img src="/assests/safaLogo.png" alt="Safa Suiting" class="w-12 h-8 dark:brightness-0 dark:invert">
    </a>
    


    <!-- Navigation Links -->
    <nav class="hidden md:flex md:space-x-6 text-base font-semibold tracking-wide ">
      <a href="/" class="nav-link active">Home</a>
      <a href="/pages/contact" class="nav-link">Contact</a>
      <a href="/pages/about" class="nav-link">About</a>
      <% if (!user) { %> 
        <a href="/auth/register" class="nav-link">Sign Up</a>
      <% } %>
    </nav>


    <!-- Search and Icons -->
    <div class="flex items-center space-x-4">

      <!-- Search Bar for Medium and Large Screens -->
      <div class="relative group">
        <input type="text" id="desktopSearchInput" placeholder="Search..."
          class="block p-2 w-48 z-20 border border-slate-400 text-black bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-300 dark:bg-gray-800 dark:text-white dark:focus:ring-gray-500 rounded-md ">
        <button id="desktopSearchIcon" class="absolute top-0 right-0 p-2 text-sm font-medium h-full text-black dark:text-white">
          <i class="bi bi-search"></i>
        </button>
      </div>

      <!-- Expanded Search Bar (Hidden by Default) -->
      <div id="expandedSearchBar"
        class="hidden p-4 bg-gray-100 border-b border-gray-300 dark:bg-gray-800 dark:border-gray-600 fixed top-8 right-0 w-full z-40">
        <div class="flex items-center space-x-2">
          <div class="relative w-full">
            <input type="text" id="expandedSearchInput" placeholder="Search..."
              class="block p-2.5 w-full text-black border-2 border-black bg-white focus:outline-none focus:ring-2 focus:ring-gray-300 dark:bg-gray-700 dark:text-white dark:border-gray-600 dark:focus:ring-gray-500 rounded-md pl-2 pr-8">

            <!-- Close Button inside the input -->
            <button id="closeSearch" class="absolute top-1/2 right-2 transform -translate-y-1/2 text-black dark:text-white text-2xl">
              <i class="bi bi-x-lg"></i>
            </button>
          </div>
        </div>

        <div id="expandedSearchResults"
          class="hidden mt-2 bg-white border border-gray-300 rounded-md shadow-lg dark:bg-gray-800 dark:border-gray-600">
          <!-- Search results will appear here -->
        </div>
      </div>

      <!-- ✅ Show Cart, Wishlist, and Account Only If Logged In -->
      <% if (user) { %>
      <button>
        <a href="/user/wishlist" class="relative hidden md:block cursor-pointer" id="wishlist">
          <i class="bi bi-heart text-2xl dark:text-white"></i>
          <span class="absolute -top-1 -right-1 bg-[#DB4444] dark:bg-[#de2d2d] text-white text-xs rounded-full px-1">3</span>
        </a>
      </button>

      <button>
        <a href="/user/cart" class="relative hidden md:block cursor-pointer" id="cart">
          <i class="bi bi-cart3 text-2xl dark:text-white"></i>
          <span class="absolute -top-1 -right-1 bg-[#DB4444] dark:bg-[#de2d2d] text-white text-xs rounded-full px-1">5</span>
        </a>
      </button>

      <!-- Account Icon -->
      <button>
        <a class="relative hidden md:block cursor-pointer" id="accountIcon">
          <i class="bi bi-person text-3xl text-black dark:text-white"></i>
        </a>
      </button>

      <!-- Account Dropdown Menu -->
      <div id="accountMenu"
        class="hidden absolute right-11 mt-72 min-w-56 bg-white shadow-lg rounded-md text-black w-48 dark:bg-gray-800 dark:text-white dark:shadow-gray-700">
        <ul>
          <li>
            <a href="/user/dashboard" class="block p-2 hover:bg-gray-100 dark:hover:bg-gray-700">
              <i class="bi bi-person mr-2"></i> Manage My Account
            </a>
          </li>
          <li>
            <a href="/user/order/user-order" class="block p-2 hover:bg-gray-100 dark:hover:bg-gray-700">
              <i class="bi bi-bag mr-2"></i> My Order
            </a>
          </li>
          <li>
            <a href="/user/order/cancel-order" class="block p-2 hover:bg-gray-100 dark:hover:bg-gray-700">
              <i class="bi bi-x-circle mr-2"></i> My Cancellations
            </a>
          </li>

          <li>
            <a href="/auth/logout" class="block p-2 hover:bg-gray-100 dark:hover:bg-gray-700">
              <i class="bi bi-box-arrow-right mr-2"></i> Logout
            </a>
          </li>
        </ul>
      </div>
      <% } %>
    </div>
  </div>

  

  <!-- Bottom Navigation for Small Screens -->
  <div
    class="border-t fixed bottom-0 left-0 w-full z-20 bg-white shadow-md md:hidden flex justify-around py-2 dark:bg-gray-900 dark:border-gray-700">
    <a href="/" class="flex flex-col items-center text-black dark:text-white">
      <i class="bi bi-house text-xl"></i>
      <span class="text-xs">Home</span>
    </a>

    <% if (user) { %>
      <!-- Wishlist (Only if Logged In) -->
    <a href="/user/wishlist" class="relative flex flex-col items-center text-black dark:text-white">
      <i class="bi bi-heart text-xl"></i>
      <span class="absolute -top-1 right-1 bg-[#DB4444] dark:bg-[#de2d2d] text-white text-xs rounded-full px-1">3</span>
      <span class="text-xs">Wishlist</span>
    </a>
    <a href="/user/cart" class="px-3 relative flex flex-col items-center text-black dark:text-white">
      <i class="bi bi-cart3 text-xl"></i>
      <span class="absolute -top-1 right-2 bg-[#DB4444] dark:bg-[#de2d2d] text-white text-xs rounded-full px-1">5</span>
      <span class="text-xs">Cart</span>

    </a>
    <% } else { %>
    <a href="/auth/register" class="flex flex-col items-center text-black dark:text-white">
      <i class="bi bi-person text-xl"></i>
      <span class="text-xs">Sign Up</span>
    </a>
    <% } %>
  </div>
</header>


<!-- <script>
document.addEventListener("DOMContentLoaded", function () {
  const searchInput = document.getElementById("desktopSearchInput");
  const searchIcon = document.getElementById("desktopSearchIcon");
  const expandedSearchBar = document.getElementById("expandedSearchBar");
  const closeSearch = document.getElementById("closeSearch");
  const expandedSearchInput = document.getElementById('expandedSearchInput'); // Expanded search input field

  // Function to show expanded search bar
  function showExpandedSearch() {
    expandedSearchBar.classList.remove("hidden");
    searchInput.parentElement.classList.add("hidden"); // Hide default search
    expandedSearchInput.focus(); // Focus on the input when expanded
  }

  // Function to hide expanded search bar
  function hideExpandedSearch() {
    expandedSearchBar.classList.add("hidden");
    searchInput.parentElement.classList.remove("hidden"); // Show default search
  }

  // Click event to show search bar
  searchInput.addEventListener("click", showExpandedSearch);
  searchIcon.addEventListener("click", showExpandedSearch);

  // Click event to close search bar
  closeSearch.addEventListener("click", hideExpandedSearch);

  // Dummy data for search
  const dummyResults = [
    'Summer Collection 2023',
    'Men’s Formal Suits',
    'Casual Wear for Women',
    'Trending Accessories',
    'New Arrivals: Kids Wear',
    'Top Picks for Winter'
  ];

  // Function to handle search input and display results
  function handleSearch(input, resultsContainer) {
    const query = input.value.toLowerCase();
    resultsContainer.innerHTML = ''; // Clear previous results

    if (query) {
      const filteredResults = dummyResults.filter(item =>
        item.toLowerCase().includes(query)
      );
      if (filteredResults.length > 0) {
        filteredResults.forEach(result => {
          const resultItem = document.createElement('div');
          resultItem.textContent = result;
          resultItem.className = 'p-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer';
          resultsContainer.appendChild(resultItem);
        });
      } else {
        const noResult = document.createElement('div');
        noResult.textContent = 'No results found';
        noResult.className = 'p-2 text-gray-500';
        resultsContainer.appendChild(noResult);
      }
      resultsContainer.classList.remove('hidden');
    } else {
      resultsContainer.classList.add('hidden');
    }
  }

  // Event listener for the expanded search input
  const expandedSearchResults = document.getElementById('expandedSearchResults');
  expandedSearchInput.addEventListener('input', () =>
    handleSearch(expandedSearchInput, expandedSearchResults)
  );

  // Hide results when clicking outside
  document.addEventListener('click', (e) => {
    // Close expanded search results
    if (
      !expandedSearchBar.contains(e.target) &&
      !expandedSearchResults.contains(e.target)
    ) {
      expandedSearchResults.classList.add('hidden');
    }
  });

});


</script> -->

<script>
  document.addEventListener("DOMContentLoaded", function () {
  const searchInput = document.getElementById("desktopSearchInput");
  const searchIcon = document.getElementById("desktopSearchIcon");
  const expandedSearchBar = document.getElementById("expandedSearchBar");
  const closeSearch = document.getElementById("closeSearch");
  const expandedSearchInput = document.getElementById("expandedSearchInput"); 
  const expandedSearchResults = document.getElementById("expandedSearchResults");

  // Function to show expanded search bar
  function showExpandedSearch() {
    expandedSearchBar.classList.remove("hidden");
    searchInput.parentElement.classList.add("hidden"); // Hide default search
    expandedSearchInput.focus(); // Focus on the input when expanded
  }

  // Function to hide expanded search bar
  function hideExpandedSearch() {
    expandedSearchBar.classList.add("hidden");
    searchInput.parentElement.classList.remove("hidden"); // Show default search
    expandedSearchResults.classList.add("hidden"); // Hide results
  }

  // Click event to show search bar
  searchInput.addEventListener("click", showExpandedSearch);
  searchIcon.addEventListener("click", showExpandedSearch);

  // Click event to close search bar
  closeSearch.addEventListener("click", hideExpandedSearch);

  // Function to handle live search
  async function handleSearch(input) {
    const query = input.value.trim().toLowerCase();
    expandedSearchResults.innerHTML = ''; // Clear previous results

    if (query.length > 0) {
      try {
        const response = await fetch(`/search/api/search?q=${query}`); // Use '/api/search'
            if (!response.ok) throw new Error("Network response was not ok");
            const results = await response.json();

            console.log("Search Results:", results); // Debugging

        if (results.length > 0) {
          results.slice(0, 12).forEach((product) => {
            const resultItem = document.createElement("div");
            resultItem.textContent = product.name;
            resultItem.className = "p-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer";
            resultItem.addEventListener("click", () => {
              window.location.href = `/search/searchResults?productId=${product._id}`;
            });
            expandedSearchResults.appendChild(resultItem);
          });
        } else {
          const noResult = document.createElement("div");
          noResult.textContent = "No results found";
          noResult.className = "p-2 text-gray-500";
          expandedSearchResults.appendChild(noResult);
        }
        expandedSearchResults.classList.remove("hidden");
      } catch (error) {
        console.error("Error fetching search results:", error);
      }
    } else {
      expandedSearchResults.classList.add("hidden");
    }
  }

  // Event listener for search input
  expandedSearchInput.addEventListener("input", () => handleSearch(expandedSearchInput));

  // Hide results when clicking outside
  document.addEventListener("click", (e) => {
    if (!expandedSearchBar.contains(e.target) && !expandedSearchResults.contains(e.target)) {
      expandedSearchResults.classList.add("hidden");
    }
  });
});

</script>

  <script>


  try {
      const accountIcon = document.getElementById('accountIcon');
      const accountMenu = document.getElementById('accountMenu');

      if (accountIcon && accountMenu) {
          // ✅ Show menu on hover
          accountIcon.addEventListener('mouseenter', () => {
              accountMenu.classList.remove('hidden');
          });

          accountMenu.addEventListener('mouseenter', () => {
              accountMenu.classList.remove('hidden');
          });

          // ✅ Hide menu when mouse leaves
          accountMenu.addEventListener('mouseleave', () => {
              accountMenu.classList.add('hidden');
          });

          accountIcon.addEventListener('mouseleave', () => {
              // Give a small delay before hiding (to allow smooth transition)
              setTimeout(() => {
                  if (!accountMenu.matches(':hover')) {
                      accountMenu.classList.add('hidden');
                  }
              }, 200); 
          });
      } else {
          console.error("❌ accountIcon or accountMenu not found in the DOM.");
      }
  } catch (error) {
      console.error("❌ Error in handling account menu visibility:", error);
  }


    

    document.querySelectorAll('.nav-link').forEach(link => {
      link.addEventListener('click', () => {
        document.querySelectorAll('.nav-link').forEach(link => link.classList.remove('active'));
        link.classList.add('active');
      });
    });

  </script>
</body>

</html>