<%- include('../shared/header') %>

<main class="container mx-auto px-4 py-12 mt-14 flex-grow">
  <!-- Breadcrumb -->
  <div class="text-sm text-[var(--color-gray-600)] mb-8">
    <nav class="flex space-x-2">
      <a href="/" class="hover:text-[var(--color-black)] transition-colors duration-300">Home</a>
      <span>/</span>
      <span class="text-[var(--color-black)] font-semibold">My Orders</span>
    </nav>
  </div>

  <!-- Main Content -->
  <div class="max-w-7xl mx-auto">
    <div class="bg-[var(--color-white)] p-6 rounded-lg shadow-lg">
      <h1 class="text-3xl font-bold text-[var(--color-black)] mb-6">My Orders</h1>
      <div class="overflow-x-auto scrollbar-thin scrollbar-thumb-[var(--color-gray-400)] scrollbar-track-[var(--color-gray-100)]">
        <table class="min-w-full table-fixed" id="productTable">
          <thead class="bg-[var(--color-gray-50)] text-[var(--color-gray-700)]">
            <tr>
              <th class="px-4 py-3 text-left w-1/6">Product Image</th>
              <th class="px-4 py-3 text-left w-1/6">Product Name</th>
              <th class="px-4 py-3 text-left w-1/6">Category</th>
              <th class="px-4 py-3 text-left w-1/6">Quantity</th>
              <th class="px-4 py-3 text-left w-1/6">Price</th>
              <th class="px-4 py-3 text-left w-1/12">Actions</th>
            </tr>
          </thead>
          <tbody class="text-[var(--color-gray-700)]" id="productList">
            <% if (orders && orders.length > 0) { %>
              <% orders.forEach(order => { %>
                <tr class="border-t border-[var(--color-gray-200)]" data-order-id="<%= order._id %>">
                  <td class="px-4 py-3">
                    <img src="<%= order.product.image %>" alt="<%= order.product.name %>" class="w-16 h-16 object-cover rounded">
                  </td>
                  <td class="px-4 py-3"><%= order.product.name %></td>
                  <td class="px-4 py-3"><%= order.product.category %></td>
                  <td class="px-4 py-3"><%= order.quantity || 1 %></td>
                  <td class="px-4 py-3">Rs <%= order.price.toFixed(2) %></td>
                  <td class="px-4 py-3 flex items-center gap-3">
                    <button 
                      class="view-btn text-[var(--color-red-500)] hover:text-[var(--color-red-700)] transition-colors duration-300" 
                      data-product-id="<%= order._id %>">View</button>
                    <button 
                      class="delete-btn text-[var(--color-red-500)] hover:text-[var(--color-red-700)] transition-colors duration-300" 
                      data-product-id="<%= order._id %>">Delete</button>
                  </td>
                </tr>
              <% }) %>
            <% } else { %>
              <tr>
                <td colspan="6" class="px-4 py-3 text-center text-[var(--color-gray-600)]">No orders found.</td>
              </tr>
            <% } %>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Pagination -->
    <div class="mt-6 flex justify-center">
      <nav aria-label="Page navigation">
        <ul class="flex items-center space-x-2 text-sm">
          <li>
            <a 
              href="#" 
              class="pagination-btn flex items-center justify-center px-3 h-8 text-[var(--color-gray-500)] bg-[var(--color-white)] border border-[var(--color-gray-300)] rounded-l-lg hover:bg-[var(--color-gray-100)] hover:text-[var(--color-gray-700)] transition-all duration-300">
              <span class="sr-only">Previous</span>
              <i class="bi bi-arrow-bar-left"></i>
            </a>
          </li>
          <li>
            <a 
              href="#" 
              class="pagination-link flex items-center justify-center px-3 h-8 text-[var(--color-gray-500)] bg-[var(--color-white)] border border-[var(--color-gray-300)] hover:bg-[var(--color-gray-100)] hover:text-[var(--color-gray-700)] transition-all duration-300">1</a>
          </li>
          <li>
            <a 
              href="#" 
              class="pagination-link flex items-center justify-center px-3 h-8 text-[var(--color-red-500)] bg-[var(--color-red-50)] border border-[var(--color-red-300)] hover:bg-[var(--color-red-100)] hover:text-[var(--color-red-700)] transition-all duration-300">2</a>
          </li>
          <li>
            <a 
              href="#" 
              class="pagination-btn flex items-center justify-center px-3 h-8 text-[var(--color-gray-500)] bg-[var(--color-white)] border border-[var(--color-gray-300)] rounded-r-lg hover:bg-[var(--color-gray-100)] hover:text-[var(--color-gray-700)] transition-all duration-300">
              <span class="sr-only">Next</span>
              <i class="bi bi-arrow-bar-right"></i>
            </a>
          </li>
        </ul>
      </nav>
    </div>
  </div>

  <!-- Product Modal (Popup) -->
  <div id="productModal" class="fixed inset-0 bg-[var(--color-black)] bg-opacity-60 flex justify-center items-center opacity-0 pointer-events-none transition-all duration-500 z-50">
    <div class="bg-[var(--color-white)] p-6 rounded-xl shadow-2xl max-w-lg w-full relative transform scale-95 transition-all duration-300">
      <button 
        id="closeModal" 
        class="absolute top-4 right-4 w-10 h-10 bg-[var(--color-red-500)] text-[var(--color-white)] rounded-full flex items-center justify-center hover:bg-[var(--color-red-700)] transition-all duration-300">
        <i class="bi bi-x-lg text-xl"></i>
      </button>
      <h3 id="modalTitle" class="text-xl font-semibold text-[var(--color-black)] mb-4">Order Details</h3>
      <div id="modalContent" class="mt-4 text-[var(--color-gray-600)]"></div>
      <div class="mt-6 flex justify-end">
        <button 
          id="closeModalBtn" 
          class="px-4 py-2 text-[var(--color-gray-600)] bg-[var(--color-gray-200)] rounded-lg hover:bg-[var(--color-gray-300)] transition-all duration-300">
          Close
        </button>
      </div>
    </div>
  </div>
</main>

<script type="module" src="/js/myOrders.js"></script>

<%- include('../shared/footer') %>